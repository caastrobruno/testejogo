<!DOCTYPE html>
<html lang="pt-BR">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=no">
<title>Super Pedido ğŸ’</title>

<style>
html,body{
  margin:0;padding:0;overflow:hidden;
  background:#000;font-family:monospace;
}
canvas{display:block;background:#5c94fc}
#hud{
  position:fixed;top:10px;left:10px;
  color:#fff;font-size:18px;z-index:5
}
.controls{
  position:fixed;bottom:15px;width:100%;
  display:flex;justify-content:space-between;
  padding:0 30px;z-index:5
}
.btn{
  width:70px;height:70px;border-radius:50%;
  background:rgba(255,255,255,.25);
  display:flex;align-items:center;justify-content:center;
  font-size:30px;color:#fff
}
#proposal{
  position:fixed;inset:0;
  background:rgba(0,0,0,.9);
  display:none;flex-direction:column;
  align-items:center;justify-content:center;
  color:white;text-align:center;z-index:10
}
#proposal button{
  font-size:24px;padding:12px 40px;margin:10px
}
</style>
</head>

<body>

<div id="hud">â¤ï¸ <span id="score">0</span></div>
<canvas id="game"></canvas>

<div class="controls">
  <div class="btn" id="left">â—€</div>
  <div class="btn" id="jump">â¤’</div>
  <div class="btn" id="right">â–¶</div>
</div>

<div id="proposal">
  <h1>ğŸ’– Quer casar comigo? ğŸ’–</h1>
  <button onclick="yes()">SIM ğŸ’</button>
  <button onclick="no()">NÃƒO</button>
  <h2 id="final"></h2>
</div>

<script>
const canvas=document.getElementById("game");
const ctx=canvas.getContext("2d");
const scoreEl=document.getElementById("score");
const proposal=document.getElementById("proposal");
const final=document.getElementById("final");

function resize(){
  canvas.width=innerWidth;
  canvas.height=innerHeight;
}
resize();addEventListener("resize",resize);

const GRAVITY=.9,SPEED=5,JUMP=-15;
const groundY=canvas.height-90;

const player={x:100,y:0,w:32,h:48,vx:0,vy:0,on:false};

let left=false,right=false;

function bind(id,down,up){
  const b=document.getElementById(id);
  b.addEventListener("touchstart",e=>{e.preventDefault();down()});
  b.addEventListener("touchend",e=>{e.preventDefault();up()});
}
bind("left",()=>left=true,()=>left=false);
bind("right",()=>right=true,()=>right=false);
bind("jump",()=>{
  if(player.on){player.vy=JUMP;player.on=false;}
},()=>{});

let cam=0,score=0;

/* WORLD */
const pipes=[
  {x:500,w:60,h:120},
  {x:900,w:60,h:160}
];

const turtles=[
  {x:650,y:groundY-32,v:1,alive:true},
  {x:1050,y:groundY-32,v:-1,alive:true}
];

const castle={x:1400,w:160,h:180};

/* UPDATE */
function update(){
  player.vx=left?-SPEED:right?SPEED:0;
  player.vy+=GRAVITY;
  player.x+=player.vx;
  player.y+=player.vy;

  if(player.y+player.h>=groundY){
    player.y=groundY-player.h;
    player.vy=0;player.on=true;
  }

  pipes.forEach(p=>{
    if(player.x<p.x+p.w &&
       player.x+player.w>p.x &&
       player.y+player.h>groundY-p.h){
      if(player.vx>0)player.x=p.x-player.w;
      if(player.vx<0)player.x=p.x+p.w;
    }
  });

  turtles.forEach(t=>{
    if(!t.alive)return;
    t.x+=t.v;
    if(player.x< t.x+32 &&
       player.x+player.w>t.x &&
       player.y< t.y+32 &&
       player.y+player.h>t.y){
      if(player.vy>0){
        t.alive=false;
        player.vy=JUMP/1.5;
        score++;scoreEl.innerText=score;
      }else{
        player.x=100;player.y=0;
      }
    }
  });

  if(player.x+player.w>castle.x){
    proposal.style.display="flex";
  }

  cam=player.x-150;
}

/* DRAW */
function draw(){
  ctx.clearRect(0,0,canvas.width,canvas.height);

  ctx.fillStyle="#7c4a16";
  ctx.fillRect(-cam,groundY,3000,90);

  pipes.forEach(p=>{
    ctx.fillStyle="#2ecc71";
    ctx.fillRect(p.x-cam,groundY-p.h,p.w,p.h);
  });

  turtles.forEach(t=>{
    if(!t.alive)return;
    ctx.fillStyle="#27ae60";
    ctx.fillRect(t.x-cam,t.y,32,32);
  });

  ctx.fillStyle="#999";
  ctx.fillRect(castle.x-cam,groundY-castle.h,castle.w,castle.h);

  ctx.fillStyle="red";
  ctx.fillRect(player.x-cam,player.y,player.w,player.h);
}

function loop(){update();draw();requestAnimationFrame(loop)}
loop();

/* PROPOSAL */
function yes(){
  final.innerText="ğŸ‰ Player 2 desbloqueado para a vida toda ğŸ‰";
}
function no(){
  final.innerText="âŒ Essa fase nÃ£o tem essa opÃ§Ã£o ğŸ˜";
}
</script>

</body>
</html>
