<!DOCTYPE html>
<html lang="pt-BR">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=no">
<title>Super Pedido üíç</title>

<style>
html,body{
  margin:0;padding:0;overflow:hidden;
  background:#000;font-family:monospace;
  touch-action:none;
}
canvas{display:block;background:#5c94fc}
#hud{
  position:fixed;top:10px;left:10px;
  color:#fff;font-size:18px;z-index:5
}
#proposal{
  position:fixed;inset:0;
  background:rgba(0,0,0,.9);
  display:none;flex-direction:column;
  align-items:center;justify-content:center;
  color:white;text-align:center;z-index:10
}
#proposal button{
  font-size:24px;padding:12px 40px;margin:10px
}
</style>
</head>

<body>

<div id="hud">‚ù§Ô∏è <span id="score">0</span></div>
<canvas id="game"></canvas>

<div id="proposal">
  <h1>üíñ Quer casar comigo? üíñ</h1>
  <button onclick="yes()">SIM üíç</button>
  <button onclick="no()">N√ÉO</button>
  <h2 id="final"></h2>
</div>

<script>
const canvas=document.getElementById("game");
const ctx=canvas.getContext("2d");
const scoreEl=document.getElementById("score");
const proposal=document.getElementById("proposal");
const final=document.getElementById("final");

function resize(){
  canvas.width=innerWidth;
  canvas.height=innerHeight;
}
resize();addEventListener("resize",resize);

/* CONSTANTS */
const GRAVITY=0.8,SPEED=5,JUMP=-17;
const groundY=canvas.height-90;

/* PLAYER */
const player={
  x:100,y:0,w:32,h:48,
  vx:0,vy:0,on:false,dir:1,step:0
};

let score=0,cam=0;

/* TOUCH CONTROL (FULL SCREEN) */
canvas.addEventListener("touchstart",e=>{
  const t=e.touches[0];
  const x=t.clientX;
  const y=t.clientY;
  const w=innerWidth;
  const h=innerHeight;

  if(y<h*0.4 && player.on){
    player.vy=JUMP;player.on=false;
  }else if(x<w/2){
    player.vx=-SPEED;player.dir=-1;
  }else{
    player.vx=SPEED;player.dir=1;
  }
});

canvas.addEventListener("touchend",()=>{
  player.vx=0;
});

/* WORLD */
const pipes=[
  {x:450,w:60,h:90},
  {x:850,w:60,h:140}
];

const castle={x:1300,w:160,h:180};

/* UPDATE */
function update(){
  player.vy+=GRAVITY;
  player.x+=player.vx;
  player.y+=player.vy;

  if(player.y+player.h>=groundY){
    player.y=groundY-player.h;
    player.vy=0;player.on=true;
  }

  pipes.forEach(p=>{
    if(player.x<p.x+p.w &&
       player.x+player.w>p.x &&
       player.y+player.h>groundY-p.h){
      if(player.vx>0)player.x=p.x-player.w;
      if(player.vx<0)player.x=p.x+p.w;
    }
  });

  if(player.x+player.w>castle.x){
    proposal.style.display="flex";
  }

  if(player.vx!==0)player.step=(player.step+1)%20;
  cam=player.x-150;
}

/* DRAW */
function draw(){
  ctx.clearRect(0,0,canvas.width,canvas.height);

  // GROUND
  ctx.fillStyle="#7c4a16";
  ctx.fillRect(-cam,groundY,3000,90);

  // PIPES
  pipes.forEach(p=>{
    ctx.fillStyle="#2ecc71";
    ctx.fillRect(p.x-cam,groundY-p.h,p.w,p.h);
  });

  // CASTLE
  ctx.fillStyle="#999";
  ctx.fillRect(castle.x-cam,groundY-castle.h,castle.w,castle.h);

  // PLAYER (MARIO STYLE)
  const x=player.x-cam,y=player.y;
  ctx.fillStyle="#ff0000"; // hat
  ctx.fillRect(x+6,y,20,8);
  ctx.fillStyle="#f1c27d"; // face
  ctx.fillRect(x+8,y+8,16,12);
  ctx.fillStyle="#ff0000"; // shirt
  ctx.fillRect(x+4,y+20,24,12);
  ctx.fillStyle="#0066ff"; // overalls
  ctx.fillRect(x+4,y+32,24,12);
  ctx.fillStyle="#000";
  ctx.fillRect(x+6+(player.step<10?0:8),y+44,6,4);
  ctx.fillRect(x+20-(player.step<10?0:8),y+44,6,4);
}

/* LOOP */
function loop(){update();draw();requestAnimationFrame(loop)}
loop();

/* PROPOSAL */
function yes(){
  final.innerText="üéâ Player 2 desbloqueado para a vida toda üéâ";
}
function no(){
  final.innerText="‚ùå Essa fase n√£o aceita essa escolha üòè";
}
</script>

</body>
</html>
